<!DOCTYPE html>
<html>
<head>
  <title>Kompass, Gyroskop und Beschleunigungssensor</title>
</head>
<body>
  <h1>Kompass, Gyroskop und Beschleunigungssensor</h1>
  <button id="permissionButton">Berechtigung erteilen</button>
  <br><br>
  <label id="compassLabel"></label>
  <br>
  <label id="gyroscopeLabel"></label>
  <br>
  <label id="accelerationLabel"></label>

  <script>
    // Funktion zum Überprüfen der Berechtigung und Starten des Kompass-, Gyroskop- und Beschleunigungssensor-Trackings
    function startSensorTracking() {
      // Überprüfen, ob der Browser den Zugriff auf den Kompass, das Gyroskop und den Beschleunigungssensor unterstützt
      if (('DeviceOrientationEvent' in window && typeof DeviceOrientationEvent.requestPermission === 'function') &&
          ('Gyroscope' in window && typeof Gyroscope === 'function') &&
          ('DeviceMotionEvent' in window && typeof DeviceMotionEvent.requestPermission === 'function')) {
        Promise.all([
          DeviceOrientationEvent.requestPermission(),
          Gyroscope.requestPermission(),
          DeviceMotionEvent.requestPermission()
        ]).then(permissionStates => {
          const compassPermission = permissionStates[0];
          const gyroscopePermission = permissionStates[1];
          const accelerationPermission = permissionStates[2];
          if (compassPermission === 'granted' && gyroscopePermission === 'granted' && accelerationPermission === 'granted') {
            // Berechtigungen erteilt, Kompass-, Gyroskop- und Beschleunigungssensor-Tracking starten
            window.addEventListener('deviceorientation', handleOrientation);
            const gyroscope = new Gyroscope();
            gyroscope.addEventListener('reading', handleGyroscope);
            gyroscope.start();
            getAcceleration();
          }
        }).catch(console.error);
      } else {
        alert('Kompass, Gyroskop oder Beschleunigungssensor wird nicht unterstützt');
      }
    }

    // Funktion zum Verarbeiten der Kompassdaten
    function handleOrientation(event) {
      // Kompass-Koordinaten abrufen
      var compassCoordinates = event.webkitCompassHeading;

      // Koordinaten im Label anzeigen
      var compassLabel = document.getElementById('compassLabel');
      compassLabel.textContent = 'Kompass-Koordinaten: ' + compassCoordinates;
    }

    // Funktion zum Verarbeiten der Gyroskopdaten
    function handleGyroscope(event) {
      // Gyroskop-Daten abrufen
      var gyroscopeData = event.target;

      // Euler-Daten berechnen
      var eulerData = {
        alpha: gyroscopeData.x,
        beta: gyroscopeData.y,
        gamma: gyroscopeData.z
      };

      // Daten im Label anzeigen
      var gyroscopeLabel = document.getElementById('gyroscopeLabel');
      gyroscopeLabel.textContent = 'Euler-Daten:\n' +
        'Alpha: ' + eulerData.alpha + '\n' +
        'Beta: ' + eulerData.beta + '\n' +
        'Gamma: ' + eulerData.gamma;
    }

    // Funktion zum Verarbeiten der Beschleunigungsdaten
    function handleAcceleration(event) {
      // Beschleunigungsdaten abrufen
      var accelerationData = event.acceleration;

      // Daten im Label anzeigen
      var accelerationLabel = document.getElementById('accelerationLabel');
      accelerationLabel.textContent = 'Beschleunigungsdaten:\n' +
        'X: ' + accelerationData.x + '\n' +
        'Y: ' + accelerationData.y + '\n' +
        'Z: ' + accelerationData.z;
    }

    // Funktion zum Anfordern der Berechtigung für den Beschleunigungssensor und Starten des Beschleunigungssensor-Trackings
    function getAcceleration() {
      DeviceMotionEvent.requestPermission().then(response => {
        if (response === 'granted') {
          // Berechtigung erteilt, Beschleunigungssensor-Tracking starten
          window.addEventListener('devicemotion', handleAcceleration);
        }
      });
    }

    // Event-Handler für den Klick auf den Berechtigungs-Button
    var permissionButton = document.getElementById('permissionButton');
    permissionButton.addEventListener('click', startSensorTracking);
  </script>
</body>
</html>
